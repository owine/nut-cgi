{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:best-practices"
  ],
  "timezone": "America/Chicago",
  "schedule": [
    "before 3am on Monday"
  ],
  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps):",
  "commitBody": "Update {{depName}} from {{currentVersion}} to {{newVersion}}\n\n{{#if releases}}Release notes:\n{{#each releases}}- {{#if title}}{{title}}{{else}}{{version}}{{/if}}\n{{/each}}{{/if}}",
  "ignorePaths": [
    "docker-compose.yml"
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Track NUT (Network UPS Tools) releases from GitHub",
      "managerFilePatterns": ["Dockerfile"],
      "matchStrings": [
        "# NUT version to build from source\\s+ARG NUT_VERSION=(?<currentValue>.*?)\\n"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "networkupstools/nut",
      "extractVersionTemplate": "^v(?<version>.*)$"
    },
    {
      "customType": "regex",
      "description": "Track Alpine 3.23 APK package versions via Repology",
      "managerFilePatterns": ["Dockerfile"],
      "matchStrings": [
        "(?<depName>lighttpd|curl|openssl|gd|build-base|autoconf|automake|libtool|pkgconf|gd-dev)=(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "repology",
      "depNameTemplate": "alpine_3_23/{{{depName}}}",
      "versioningTemplate": "loose"
    },
    {
      "customType": "regex",
      "description": "Track Alpine base image version in FROM statements",
      "managerFilePatterns": ["Dockerfile"],
      "matchStrings": [
        "FROM alpine:(?<currentValue>\\d+\\.\\d+\\.\\d+)@"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "alpine"
    }
  ],
  "packageRules": [
    {
      "description": "Alpine Docker base image - auto-merge patch and digest updates",
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "alpine"
      ],
      "groupName": "alpine docker image",
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": [
        "patch",
        "digest"
      ]
    },
    {
      "description": "NUT source version - manual review required",
      "matchDatasources": [
        "github-releases"
      ],
      "matchPackageNames": [
        "networkupstools/nut"
      ],
      "groupName": "nut source",
      "automerge": false
    },
    {
      "description": "Alpine APK packages - auto-merge patch updates (NOTE: When upgrading Alpine base to 3.24+, update repology depNameTemplate in customManagers)",
      "matchDatasources": [
        "repology"
      ],
      "matchPackageNames": [
        "/^alpine_3_23/"
      ],
      "groupName": "alpine apk packages",
      "automerge": true,
      "matchUpdateTypes": [
        "patch"
      ]
    },
    {
      "description": "GitHub Actions - auto-merge minor and patch updates",
      "matchManagers": [
        "github-actions"
      ],
      "groupName": "github actions",
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": [
        "patch",
        "minor"
      ]
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": [
      "security"
    ],
    "assignees": [
      "owine"
    ]
  },
  "prConcurrentLimit": 5,
  "prHourlyLimit": 2
}
